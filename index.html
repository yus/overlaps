<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sacred Time Portals - 22 Overlaps</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: linear-gradient(135deg, #0b0b2d 0%, #1a1a3d 100%);
            color: #e0e0ff;
            min-height: 100vh;
            padding: 20px;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        /* Header */
        .sacred-header {
            text-align: center;
            padding: 40px 0;
            margin-bottom: 40px;
            position: relative;
        }
        
        .sacred-header::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 200px;
            height: 3px;
            background: linear-gradient(90deg, transparent, #6c63ff, transparent);
        }
        
        h1 {
            font-size: 3.5rem;
            background: linear-gradient(45deg, #6c63ff, #ff6b9d, #4dccff);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            margin-bottom: 10px;
            letter-spacing: 1px;
        }
        
        .subtitle {
            font-size: 1.3rem;
            color: #a0a0ff;
            font-style: italic;
            margin-bottom: 20px;
        }
        
        .verse {
            display: inline-block;
            padding: 12px 25px;
            background: rgba(108, 99, 255, 0.1);
            border-radius: 50px;
            border: 1px solid rgba(108, 99, 255, 0.3);
            color: #a0a0ff;
            font-size: 1.1rem;
            margin-top: 15px;
        }
        
        /* Main Layout */
        .sacred-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 40px;
        }
        
        @media (max-width: 900px) {
            .sacred-grid { grid-template-columns: 1fr; }
        }
        
        /* Cards */
        .sacred-card {
            background: rgba(20, 20, 50, 0.7);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            border: 1px solid rgba(108, 99, 255, 0.2);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.3);
            transition: transform 0.3s;
        }
        
        .sacred-card:hover {
            transform: translateY(-5px);
        }
        
        .sacred-card h2 {
            color: #6c63ff;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(108, 99, 255, 0.3);
            font-size: 1.8rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        /* Clock */
        .clock-container {
            text-align: center;
        }
        
        #main-clock {
            width: 280px;
            height: 280px;
            margin: 0 auto 30px;
            position: relative;
            border-radius: 50%;
            background: radial-gradient(circle, #1a1a3d 30%, #0b0b2d 100%);
            border: 12px solid #2a2a5d;
            box-shadow: 
                0 0 40px rgba(108, 99, 255, 0.3),
                inset 0 0 40px rgba(0, 0, 0, 0.7);
        }
        
        .clock-hand {
            position: absolute;
            bottom: 50%;
            left: 50%;
            transform-origin: bottom;
            transform: translateX(-50%);
            border-radius: 8px;
            transition: transform 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
        }
        
        #hour-hand {
            width: 8px;
            height: 30%;
            background: linear-gradient(to top, #ff6b9d, #ff8e6b);
            z-index: 3;
        }
        
        #minute-hand {
            width: 6px;
            height: 40%;
            background: linear-gradient(to top, #6c63ff, #4dccff);
            z-index: 2;
        }
        
        .clock-center {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 20px;
            height: 20px;
            background: #fff;
            border-radius: 50%;
            transform: translate(-50%, -50%);
            z-index: 10;
            box-shadow: 0 0 15px rgba(108, 99, 255, 0.8);
        }
        
        /* Time Displays */
        .time-display {
            font-size: 2.2rem;
            color: #4dccff;
            font-family: 'Courier New', monospace;
            margin: 15px 0;
            text-shadow: 0 0 10px rgba(77, 204, 255, 0.5);
        }
        
        .next-portal {
            font-size: 1.5rem;
            color: #ff8e6b;
            margin: 15px 0;
            padding: 15px;
            background: rgba(255, 142, 107, 0.1);
            border-radius: 12px;
            border: 1px solid rgba(255, 142, 107, 0.3);
        }
        
        /* Controls */
        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 25px;
            flex-wrap: wrap;
        }
        
        .sacred-btn {
            padding: 14px 28px;
            background: linear-gradient(45deg, #6c63ff, #4dccff);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 5px 20px rgba(108, 99, 255, 0.4);
        }
        
        .sacred-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(108, 99, 255, 0.6);
        }
        
        .sacred-btn:active {
            transform: translateY(1px);
        }
        
        /* Portal Ring */
        .portal-ring-container {
            position: relative;
            margin: 30px auto;
            width: 350px;
            height: 350px;
        }
        
        #portal-ring {
            width: 100%;
            height: 100%;
            position: relative;
            border-radius: 50%;
            border: 2px dashed rgba(108, 99, 255, 0.3);
        }
        
        .portal-dot {
            position: absolute;
            width: 45px;
            height: 45px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            transition: all 0.3s ease;
            transform-origin: center;
            font-family: 'Times New Roman', serif;
            font-size: 1.5rem;
        }
        
        .portal-dot:hover {
            transform: scale(1.3);
            z-index: 10;
        }
        
        .portal-dot.day-portal {
            background: rgba(255, 142, 107, 0.9);
            border: 2px solid #ff8e6b;
            color: #000;
        }
        
        .portal-dot.night-portal {
            background: rgba(108, 99, 255, 0.9);
            border: 2px solid #6c63ff;
            color: white;
        }
        
        .portal-dot.current-portal {
            background: rgba(77, 204, 255, 0.9);
            border: 3px solid #4dccff;
            box-shadow: 0 0 25px #4dccff;
            z-index: 5;
            color: white;
        }
        
        .portal-number {
            position: absolute;
            top: -25px;
            left: 50%;
            transform: translateX(-50%);
            color: #a0a0ff;
            font-size: 0.8rem;
            white-space: nowrap;
        }
        
        .connection-line {
            position: absolute;
            height: 1px;
            background: rgba(108, 99, 255, 0.2);
            transform-origin: 0 0;
            z-index: 1;
        }
        
        /* Overlap List */
        .overlaps-list {
            max-height: 400px;
            overflow-y: auto;
            margin-top: 20px;
            padding-right: 10px;
        }
        
        .overlap-item {
            padding: 15px;
            margin: 10px 0;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            border-left: 4px solid;
            transition: all 0.3s;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
        }
        
        .overlap-item:hover {
            background: rgba(108, 99, 255, 0.15);
            transform: translateX(5px);
        }
        
        .overlap-day { border-left-color: #ff8e6b; }
        .overlap-night { border-left-color: #6c63ff; }
        
        .overlap-time {
            font-size: 1.3rem;
            font-family: 'Courier New', monospace;
            color: #4dccff;
        }
        
        .overlap-index {
            color: #a0a0ff;
            font-size: 0.9rem;
        }
        
        /* Math Panel */
        .math-panel {
            grid-column: 1 / -1;
            margin-top: 20px;
        }
        
        .formula {
            background: rgba(0, 0, 0, 0.3);
            padding: 20px;
            border-radius: 15px;
            margin: 15px 0;
            border-left: 5px solid #ff6b9d;
            font-family: 'Courier New', monospace;
            font-size: 1.2rem;
            color: #ff8e6b;
        }
        
        /* Footer */
        .sacred-footer {
            text-align: center;
            padding: 40px 0 20px;
            margin-top: 40px;
            border-top: 1px solid rgba(108, 99, 255, 0.2);
            color: #8888cc;
            font-size: 0.9rem;
        }
        
        .blessing {
            color: #6c63ff;
            font-size: 1.1rem;
            margin-top: 10px;
        }

        canvas {
            max-width: 100%;
            height: auto;
            display: block;
        }
        
        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: rgba(108, 99, 255, 0.5);
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: rgba(108, 99, 255, 0.7);
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="sacred-header">
            <h1>üåÄ SACRED TIME PORTALS</h1>
            <div class="subtitle">22 Moments When Clock Hands Unite in Divine Harmony</div>
            <div class="verse">"For everything there is a season, and a time for every matter under heaven."</div>
        </header>
        
        <div class="sacred-grid">
            <!-- Left Panel: Main Clock & Controls -->
            <div class="sacred-card">
                <h2>üïê DIVINE CLOCK</h2>
                <div class="clock-container">
                    <div id="main-clock">
                        <div class="clock-hand" id="hour-hand"></div>
                        <div class="clock-hand" id="minute-hand"></div>
                        <div class="clock-center"></div>
                    </div>
                    
                    <div class="time-display" id="current-time">00:00:00</div>
                    <div class="next-portal" id="next-portal">Next portal in: --:--:--</div>
                    
                    <div class="controls">
                        <button class="sacred-btn" id="prev-btn">‚óÄ Previous</button>
                        <button class="sacred-btn" id="real-btn">‚è±Ô∏è Real Time</button>
                        <button class="sacred-btn" id="next-btn">Next ‚ñ∂</button>
                    </div>
                </div>
            </div>
            
            <!-- Right Panel: Portal Ring -->
            <div class="sacred-card">
                <h2>üåÄ SACRED PORTAL RING</h2>
                <div class="portal-ring-container">
                    <div id="portal-ring"></div>
                </div>
                
                <div class="controls">
                    <button class="sacred-btn" id="spin-left">‚ü≤ Spin Left</button>
                    <button class="sacred-btn" id="reset-view">Reset View</button>
                    <button class="sacred-btn" id="spin-right">‚ü≥ Spin Right</button>
                </div>
                
                <div style="text-align: center; margin-top: 20px;">
                    <div style="color: #4dccff; font-size: 2.5rem; font-family: 'Times New Roman';" id="current-hebrew">◊ê</div>
                    <div style="color: #ff8e6b; font-size: 1.2rem;" id="current-portal-name">Aleph ‚Äî First Breath</div>
                    <div style="color: #a0a0ff; margin-top: 10px;" id="current-portal-time">12:00:00 AM</div>
                </div>
            </div>
            
            <!-- Bottom Left: Overlap List -->
            <div class="sacred-card">
                <h2>üìú ALL 22 PORTALS</h2>
                <div class="overlaps-list" id="overlaps-list">
                    <!-- Portals will be inserted here -->
                </div>
            </div>
            
            <!-- Bottom Right: Mathematics -->
            <div class="sacred-card">
                <h2>üßÆ SACRED MATHEMATICS</h2>
                <div class="formula">
                    Time between portals = <strong>12/11 hours</strong><br>
                    = 720/11 minutes ‚âà <strong>65.4545 minutes</strong><br>
                    = <strong>1 hour 5 minutes 27.27 seconds</strong>
                </div>
                
                <div class="formula">
                    12 hours √∑ (12/11) = <strong>11 portals</strong><br>
                    24 hours √∑ (12/11) = <strong>22 portals total</strong><br>
                    <strong>11 day portals + 11 night portals</strong>
                </div>
                
                <div style="margin-top: 20px; color: #a0a0ff;">
                    <p>The hour hand moves at 30¬∞/hour, the minute hand at 360¬∞/hour.</p>
                    <p>Relative speed difference: 330¬∞/hour.</p>
                    <p>Time to realign: 360¬∞ √∑ 330¬∞/hour = <strong>12/11 hours</strong>.</p>
                    <p>This creates perfect mathematical harmony in God's design of time.</p>
                </div>
            </div>
        </div>
        
        <footer class="sacred-footer">
            <p>"He has made everything beautiful in its time." ‚Äî Ecclesiastes 3:11</p>
            <p class="blessing">May you find sacred moments in the rhythm of the hours. üôè‚ú®</p>
            <p>Sacred Time Portals v1.0 ‚Ä¢ 22 = Divine Perfection</p>
        </footer>
    </div>

    <script>
// ============================================
// SACRED PORTAL DATA
// ============================================
const sacredPortals = [
    { hebrew: "◊ê", name: "Aleph", desc: "First Breath of Creation", time: "00:00:00" },
    { hebrew: "◊ë", name: "Bet", desc: "House of the Divine", time: "01:05:27" },
    { hebrew: "◊í", name: "Gimel", desc: "Cosmic Nourishment", time: "02:10:55" },
    { hebrew: "◊ì", name: "Dalet", desc: "Doorway to Wisdom", time: "03:16:22" },
    { hebrew: "◊î", name: "He", desc: "Window to Heaven", time: "04:21:49" },
    { hebrew: "◊ï", name: "Vav", desc: "Connecting Above & Below", time: "05:27:16" },
    { hebrew: "◊ñ", name: "Zayin", desc: "Sacred Sustenance", time: "06:32:43" },
    { hebrew: "◊ó", name: "Chet", desc: "Life Force Energy", time: "07:38:11" },
    { hebrew: "◊ò", name: "Tet", desc: "Hidden Goodness", time: "08:43:38" },
    { hebrew: "◊ô", name: "Yod", desc: "Divine Spark", time: "09:49:05" },
    { hebrew: "◊õ", name: "Kaf", desc: "Crown of Manifestation", time: "10:54:33" },
    { hebrew: "◊ú", name: "Lamed", desc: "Teaching Heart", time: "12:00:00" },
    { hebrew: "◊û", name: "Mem", desc: "Waters of Wisdom", time: "13:05:27" },
    { hebrew: "◊†", name: "Nun", desc: "Eternal Faithfulness", time: "14:10:55" },
    { hebrew: "◊°", name: "Samekh", desc: "Divine Support", time: "15:16:22" },
    { hebrew: "◊¢", name: "Ayin", desc: "Inner Vision", time: "16:21:49" },
    { hebrew: "◊§", name: "Pe", desc: "Mouth of Creation", time: "17:27:16" },
    { hebrew: "◊¶", name: "Tsadi", desc: "Righteous Path", time: "18:32:43" },
    { hebrew: "◊ß", name: "Qof", desc: "Holiness in Time", time: "19:38:11" },
    { hebrew: "◊®", name: "Resh", desc: "Higher Consciousness", time: "20:43:38" },
    { hebrew: "◊©", name: "Shin", desc: "Fire of Transformation", time: "21:49:05" },
    { hebrew: "◊™", name: "Tav", desc: "Completion & Truth", time: "22:54:33" }
];

// ============================================
// GLOBAL STATE
// ============================================
let currentTimeMinutes = 0;
let isRealTime = true;
let portalRotation = 0;
let currentPortalIndex = 0;
let realTimeInterval;

// ============================================
// CORE FUNCTIONS
// ============================================

// Calculate all overlap times
function calculateOverlapTimes() {
    const overlaps = [];
    const interval = 12/11; // hours between overlaps
    
    for (let i = 0; i < 22; i++) {
        const totalMinutes = i * interval * 60;
        const hours = Math.floor(totalMinutes / 60) % 24;
        const minutes = Math.floor(totalMinutes % 60);
        const seconds = Math.floor((totalMinutes % 1) * 60);
        
        const timeString = `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        const period = hours < 12 ? 'AM' : 'PM';
        const displayHours = hours % 12 || 12;
        const displayString = `${displayHours}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')} ${period}`;
        
        const isDay = (hours >= 6 && hours < 18);
        
        overlaps.push({
            index: i + 1,
            hours, minutes, seconds,
            timeString, displayString,
            totalMinutes,
            isDay,
            hebrew: sacredPortals[i].hebrew,
            portalName: sacredPortals[i].name
        });
    }
    
    return overlaps;
}

// Update main clock display
function updateClock(minutes) {
    const hourAngle = (minutes / 60 * 30) % 360;
    const minuteAngle = (minutes % 60) * 6;
    
    document.getElementById('hour-hand').style.transform = 
        `translateX(-50%) rotate(${hourAngle}deg)`;
    document.getElementById('minute-hand').style.transform = 
        `translateX(-50%) rotate(${minuteAngle}deg)`;
    
    // Update time display
    const totalSeconds = Math.floor(minutes * 60);
    const hrs = Math.floor(totalSeconds / 3600) % 24;
    const mins = Math.floor((totalSeconds % 3600) / 60);
    const secs = totalSeconds % 60;
    
    document.getElementById('current-time').textContent = 
        `${hrs.toString().padStart(2, '0')}:${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
}

// Find next portal time
function findNextPortal(currentMinutes) {
    const overlaps = calculateOverlapTimes();
    let nextPortal = null;
    let minDiff = Infinity;
    
    for (const overlap of overlaps) {
        const diff = overlap.totalMinutes - currentMinutes;
        if (diff > 0 && diff < minDiff) {
            minDiff = diff;
            nextPortal = overlap;
        }
    }
    
    // If no future portal, use first one tomorrow
    if (!nextPortal) {
        nextPortal = overlaps[0];
        minDiff = (24*60 - currentMinutes) + nextPortal.totalMinutes;
    }
    
    // Format countdown
    const hrs = Math.floor(minDiff / 60);
    const mins = Math.floor(minDiff % 60);
    const secs = Math.floor((minDiff % 1) * 60);
    
    document.getElementById('next-portal').innerHTML = 
        `Next portal in: <strong>${hrs.toString().padStart(2, '0')}:${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}</strong><br>
        <small>At ${nextPortal.displayString} (${nextPortal.portalName})</small>`;
    
    return nextPortal;
}

// Create portal ring visualization
function createPortalRing() {
    const ring = document.getElementById('portal-ring');
    ring.innerHTML = '';
    
    const radius = 150;
    const centerX = 175;
    const centerY = 175;
    
    // Create connection lines
    for (let i = 0; i < 22; i++) {
        const nextI = (i + 1) % 22;
        const angle1 = (i * (360/22) - 90) * (Math.PI / 180);
        const angle2 = (nextI * (360/22) - 90) * (Math.PI / 180);
        
        const x1 = centerX + radius * Math.cos(angle1);
        const y1 = centerY + radius * Math.sin(angle1);
        const x2 = centerX + radius * Math.cos(angle2);
        const y2 = centerY + radius * Math.sin(angle2);
        
        const line = document.createElement('div');
        line.className = 'connection-line';
        
        const length = Math.sqrt(Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2));
        const angle = Math.atan2(y2 - y1, x2 - x1) * (180 / Math.PI);
        
        line.style.width = length + 'px';
        line.style.left = x1 + 'px';
        line.style.top = y1 + 'px';
        line.style.transform = `rotate(${angle}deg)`;
        
        ring.appendChild(line);
    }
    
    // Create portal dots
    for (let i = 0; i < 22; i++) {
        const portal = sacredPortals[i];
        const angle = (i * (360/22) - 90) * (Math.PI / 180);
        
        const x = centerX + radius * Math.cos(angle);
        const y = centerY + radius * Math.sin(angle);
        
        const portalDot = document.createElement('div');
        
        // Determine if day or night
        const hourNum = parseInt(portal.time.split(':')[0]);
        const isDay = hourNum >= 6 && hourNum < 18;
        
        portalDot.className = `portal-dot ${isDay ? 'day-portal' : 'night-portal'}`;
        portalDot.style.left = (x - 22.5) + 'px';
        portalDot.style.top = (y - 22.5) + 'px';
        portalDot.dataset.index = i;
        
        portalDot.innerHTML = `
            <div>${portal.hebrew}</div>
            <div class="portal-number">${i + 1}</div>
        `;
        
        // Click event
        portalDot.addEventListener('click', function() {
            selectPortal(i);
            isRealTime = false;
        });
        
        ring.appendChild(portalDot);
    }
}

// Select a specific portal
function selectPortal(index) {
    currentPortalIndex = index;
    const portal = sacredPortals[index];
    
    // Update portal info display
    document.getElementById('current-hebrew').textContent = portal.hebrew;
    document.getElementById('current-portal-name').textContent = `${portal.name} ‚Äî ${portal.desc}`;
    
    // Format time with AM/PM
    const [hours, minutes, seconds] = portal.time.split(':');
    const hourNum = parseInt(hours);
    const ampm = hourNum >= 12 ? 'PM' : 'AM';
    const displayHour = hourNum % 12 || 12;
    document.getElementById('current-portal-time').textContent = 
        `${displayHour}:${minutes}:${seconds} ${ampm}`;
    
    // Update portal dots
    document.querySelectorAll('.portal-dot').forEach((dot, i) => {
        dot.classList.remove('current-portal');
        if (i === index) {
            dot.classList.add('current-portal');
        }
    });
    
    // Update main clock
    const interval = (12/11) * 60;
    currentTimeMinutes = index * interval;
    updateClock(currentTimeMinutes);
    findNextPortal(currentTimeMinutes);
    
    // Highlight in overlap list
    document.querySelectorAll('.overlap-item').forEach((item, i) => {
        if (i === index) {
            item.style.background = 'rgba(77, 204, 255, 0.2)';
        } else {
            item.style.background = '';
        }
    });
}

// Create overlap list
function createOverlapList() {
    const list = document.getElementById('overlaps-list');
    list.innerHTML = '';
    
    const overlaps = calculateOverlapTimes();
    
    overlaps.forEach((overlap, index) => {
        const item = document.createElement('div');
        item.className = `overlap-item ${overlap.isDay ? 'overlap-day' : 'overlap-night'}`;
        item.dataset.index = index;
        
        item.innerHTML = `
            <div>
                <div style="font-size: 1.5rem; font-family: 'Times New Roman';">${overlap.hebrew}</div>
                <div style="font-size: 0.9rem; color: #a0a0ff;">${overlap.portalName}</div>
            </div>
            <div style="text-align: right;">
                <div class="overlap-time">${overlap.displayString}</div>
                <div class="overlap-index">Portal #${overlap.index}</div>
            </div>
        `;
        
        // Click event
        item.addEventListener('click', function() {
            selectPortal(index);
            isRealTime = false;
        });
        
        list.appendChild(item);
    });
}

// ============================================
// INITIALIZATION
// ============================================

function init() {
    // Create visualizations
    createPortalRing();
    createOverlapList();
    
    // Start with current time
    const now = new Date();
    currentTimeMinutes = now.getHours() * 60 + now.getMinutes() + now.getSeconds() / 60;
    updateClock(currentTimeMinutes);
    findNextPortal(currentTimeMinutes);
    
    // Find and select current portal
    const interval = (12/11) * 60;
    currentPortalIndex = Math.round(currentTimeMinutes / interval) % 22;
    selectPortal(currentPortalIndex);
    
    // Real-time updates
    realTimeInterval = setInterval(() => {
        if (isRealTime) {
            const now = new Date();
            currentTimeMinutes = now.getHours() * 60 + now.getMinutes() + now.getSeconds() / 60;
            updateClock(currentTimeMinutes);
            findNextPortal(currentTimeMinutes);
            
            // Update current portal
            const newPortalIndex = Math.round(currentTimeMinutes / interval) % 22;
            if (newPortalIndex !== currentPortalIndex) {
                currentPortalIndex = newPortalIndex;
                selectPortal(currentPortalIndex);
            }
        }
    }, 1000);
    
    // ============================================
    // EVENT LISTENERS
    // ============================================
    
    // Navigation buttons
    document.getElementById('prev-btn').addEventListener('click', () => {
        isRealTime = false;
        let newIndex = currentPortalIndex - 1;
        if (newIndex < 0) newIndex = 21;
        selectPortal(newIndex);
    });
    
    document.getElementById('next-btn').addEventListener('click', () => {
        isRealTime = false;
        let newIndex = (currentPortalIndex + 1) % 22;
        selectPortal(newIndex);
    });
    
    document.getElementById('real-btn').addEventListener('click', () => {
        isRealTime = true;
        const now = new Date();
        currentTimeMinutes = now.getHours() * 60 + now.getMinutes() + now.getSeconds() / 60;
        updateClock(currentTimeMinutes);
        findNextPortal(currentTimeMinutes);
        
        const interval = (12/11) * 60;
        currentPortalIndex = Math.round(currentTimeMinutes / interval) % 22;
        selectPortal(currentPortalIndex);
    });
    
    // Portal ring controls
    const ring = document.getElementById('portal-ring');
    
    document.getElementById('spin-left').addEventListener('click', () => {
        portalRotation -= 30;
        ring.style.transform = `rotate(${portalRotation}deg)`;
    });
    
    document.getElementById('spin-right').addEventListener('click', () => {
        portalRotation += 30;
        ring.style.transform = `rotate(${portalRotation}deg)`;
    });
    
    document.getElementById('reset-view').addEventListener('click', () => {
        portalRotation = 0;
        ring.style.transform = `rotate(${portalRotation}deg)`;
        
        // Return to real time
        isRealTime = true;
        const now = new Date();
        currentTimeMinutes = now.getHours() * 60 + now.getMinutes() + now.getSeconds() / 60;
        updateClock(currentTimeMinutes);
        findNextPortal(currentTimeMinutes);
        
        const interval = (12/11) * 60;
        currentPortalIndex = Math.round(currentTimeMinutes / interval) % 22;
        selectPortal(currentPortalIndex);
    });
    
    // Auto-rotate ring gently
    setInterval(() => {
        if (Math.random() < 0.3) { // 30% chance every 5 seconds
            portalRotation += 5;
            ring.style.transform = `rotate(${portalRotation}deg)`;
        }
    }, 5000);
}

// Start everything
window.addEventListener('load', init);
    </script>
</body>
</html>
